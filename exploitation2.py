import datetime
from datetime import datetime, timedelta
import matplotlib.pyplot as plt

nb_tags = 4

ignored = []

tag_names = ["chambre", "couloir", "radiateur", "salon"]
label = ["Chambre", "Couloir", "Radiateur", "Salon"]
top = ["radiateur"]
#bottom = []

tags = []
times = []

for i in range(nb_tags):
    tags.append([])
    times.append([])

for i in range(len(tag_names)):
    if i in ignored:
        continue
    with open(f"{tag_names[i]}.txt", "r") as f:
        line="1"
        while line:
            line=f.readline()
            sp = line.replace("\n", "").split(",")
            if len(sp) >= 2:
                times[i].append(datetime.fromtimestamp(int(sp[0])))
                tags[i].append(float(sp[1]))


plt.figure(0, figsize=(20,14))

for i in range(nb_tags):
    if i in ignored:
        continue
    if tag_names[i] in top:
        plt.subplot(2, 1, 1)
    else:
        plt.subplot(2, 1, 2)
        
    line = plt.plot(times[i], tags[i], "o", markersize=5.0)
    line[0].set_label(label[i])


plt.subplot(2, 1, 1)
plt.legend()

plt.subplot(2, 1, 2)
plt.legend()

for i in range(1,3):
    plt.subplot(2, 1, i)
    plt.xlim([datetime.now() + timedelta(days=-1), datetime.now() + timedelta(minutes=30)])
# plt.show()
plt.savefig("24hours.png")

for i in range(1,3):
    plt.subplot(2, 1, i)
    plt.xlim([datetime.now() + timedelta(hours=-12), datetime.now() + timedelta(minutes=30)])
plt.savefig("12hours.png")

for i in range(1,3):
    plt.subplot(2, 1, i)
    plt.xlim([datetime.now() + timedelta(days=-5), datetime.now() + timedelta(hours=1)])
plt.savefig("5days.png")
